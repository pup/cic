<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
</head>
<body>
<script type="text/javascript" src="./cic-inside-iframe.js"></script>
<script type="text/javascript">
    // 用setTimeout故意延迟几秒，等待重试连接
    setTimeout(function() {
        var listener = window.CicInsideIframe.createListener();

        listener.onConnect(function() {
            console.log('> 连接已建立');
        });

        listener.onMessage(function(dataFromParent) {
            console.log('> dataFromParent =');
            console.log(dataFromParent);

            if(dataFromParent.text === 'hello') {
                listener.postMessageToParent({
                    text: 'world'
                });
            }
        });

        listener.onDisconnect(function() {
            console.log('> 回调disconnect方法')
            listener.destroy();
        });

        listener.start();
    }, 3000);
</script>

</body>
</html>

